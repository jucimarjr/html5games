<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title>Zombie Invaders</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
	<script type="text/javascript" src="js/FilePaths.js"></script>
	<script type="text/javascript" src="js/Zombie.js"></script>
	<style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
var cursors;
var spriteMuro;
var spriteZombie;
var numeroDePessoas;
var numeroDeZumbis;
var grupoZumbis;
var grupoPessoas;
//var zombie;

function preload()
{
	
	game.load.image('muro', imageMuro);
	game.load.image('rua',imageRua);
	game.load.image('zombie',imageZombie);
	game.load.image('pessoa',imagePessoa);
	
}

function create()
{
	//game.physics.startSystem(Phaser.Physics.ARCADE);
	
	cursors = game.input.keyboard.createCursorKeys();
	
	spriteMuro = game.add.sprite(0, 0, 'muro');
	
	
	game.physics.arcade.enable(spriteMuro);
	spriteMuro.body.immovable = true;
	
	//Grupo de zumbis	
	grupoZumbis = game.add.group();
	grupoZumbis.enableBody = true;
	grupoZumbis.physicsBodyType = Phaser.Physics.ARCADE;
	initZombies(grupoZumbis);
	
	//Grupo de pessoas
	grupoPessoas = game.add.group();
	grupoPessoas.enableBody = true;
	grupoPessoas.physicsBodyType = Phaser.Physics.ARCADE;
	initPessoas(grupoPessoas);
	
}

function update() 
{
	game.physics.arcade.overlap(grupoZumbis, grupoPessoas, collisionHandler, null, this);
    //game.physics.arcade.overlap(enemyBullets, player, enemyHitsPlayer, null, this);
	//zombie.move();
	//moveZombies(grupoZumbis);
}

function collisionHandler(zumbi,pessoa) {
	console.log("colis√£o");
	pessoa.kill();
	var zumbi = grupoZumbis.create(pessoa.x, pessoa.y, 'zombie');
	zumbi.inputEnabled=true;
    zumbi.body.velocity.x  = 20;
    zumbi.events.onInputDown.add(elimine = function(zumbi){
		zumbi.destroy();
	},null);

}



function setHighScore()
{
   
}

function outOfBounds(object) {

};

function initZombies(grupoZumbis){
	
    for (var i = 0; i < 5; i++)
    {
       	var zumbi = grupoZumbis.create(i*80+1, 300, 'zombie');
       	game.physics.enable(zumbi,Phaser.Physics.ARCADE);
        zumbi.inputEnabled=true;
        zumbi.body.velocity.x  = 20;
        zumbi.events.onInputDown.add(elimine = function(zumbi){
			zumbi.destroy();
		},null);
    }
}

function initPessoas(grupoPessoas){
	
	for (var i = 0; i < 3; i++)
    {
       	var pessoa = grupoPessoas.create(800-i*80, 300, 'pessoa');
       	game.physics.enable(pessoa,Phaser.Physics.ARCADE);
        pessoa.body.velocity.x  = -20;
    }
}


</script>

</body>
</html>